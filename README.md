# Break Points

Break Points is an R-based tool designed to identify cleavage targets of a specific endonuclease using RNA-seq data from knockout experiments. The program detects candidate cleavage sites (break points) by comparing 5â€² and 3â€² read-start profiles between control and mutant strains.

This tool is intended to complement the **frtc pipeline**, which processes raw RNA-seq data and generates the required `.bedgraph` profile files.

---

## ðŸ“Œ Table of Contents

- [Overview](#overview)
- [Experimental Requirements](#experimental-requirements)
- [Algorithm Description](#algorithm-description)
- [Installation](#installation)
- [Usage](#usage)
- [Input Files](#input-files)
- [Output](#output)
- [Recommended Workflow](#recommended-workflow)
- [Citation](#citation)
- [Contact](#contact)

---

## Overview

Break Points identifies endonuclease-dependent RNA cleavage sites by:

1. Detecting genomic positions with characteristic 5â€² and 3â€² read accumulation.
2. Comparing signal intensity between control and knockout strains.
3. Reporting sites with significant differential cleavage signatures.

The method is specifically designed for detecting direct cleavage events caused by an endonuclease.

---

## Experimental Requirements

For reliable results:

- The target molecule **must be an endonuclease**.
- The RNA-seq data **must originate from a knockout experiment**.
- It is strongly recommended that the RNA-seq library preparation **does not fragment RNA**, as fragmentation may obscure cleavage signals.

---

## Algorithm Description

### Break Point Definition

A genomic position is classified as a **break point** if:

- A position in the **5â€² profile** has a read count â‰¥ 10, and  
- Within a maximum interval of **3 base pairs**, a position in the **3â€² profile** also has a read count â‰¥ 10.

This pattern indicates a potential RNA cleavage site.

The algorithm also performs reciprocal analysis (3â€² â†’ 5â€²), which is not relevant for single-end sequencing data.

---

### Differential Analysis

After identifying candidate break points, the program compares control and mutant strains.

A break point is considered **endonuclease-influenced** if:

- `log2 fold change â‰¥ 1`, and  
- The control strain shows higher read counts than the mutant strain.

These positions are reported as enzyme-dependent cleavage sites.

---

## Installation

### Requirements

- R (version â‰¥ 4.0 recommended)
- Linux or Unix-like operating system

Clone the repository:

```bash
git clone https://github.com/<your-username>/break-points.git
cd break-points
```

Ensure that `Rscript` is available in your system path:

```bash
Rscript --version
```

---

## Usage

Run from the command line:

```bash
Rscript brk.R <Control_5prime.bedgraph> \
              <Mutant_5prime.bedgraph> \
              <Control_3prime.bedgraph> \
              <Mutant_3prime.bedgraph> \
              <Control_Coverage.bedgraph> \
              <Mutant_Coverage.bedgraph> \
              <Chromosome> \
              <Output_Name>
```

### Arguments

| Argument | Description |
|----------|------------|
| 1 | Control strain â€“ 5â€² profile (.bedgraph) |
| 2 | Mutant strain â€“ 5â€² profile (.bedgraph) |
| 3 | Control strain â€“ 3â€² profile (.bedgraph) |
| 4 | Mutant strain â€“ 3â€² profile (.bedgraph) |
| 5 | Control coverage (.bedgraph) |
| 6 | Mutant coverage (.bedgraph) |
| 7 | Chromosome identifier |
| 8 | Output prefix (optional, default = `out`) |

It is recommended to assign file paths to shell variables before execution for clarity.

---

## Input Files

The program requires `.bedgraph` files generated by the **frtc pipeline**, including:

- 5â€² read-start profiles
- 3â€² read-end profiles
- Coverage profiles

Each file must correspond to the same genome assembly and chromosome.

---

## Output

The program generates two directories:

### `Raw_Tables/`

Contains tabular data with:

- Identified break points
- Read counts
- Fold changes
- Associated metadata

### `Bedgraph_Version/`

Contains bedgraph-formatted files ready for visualization in genome browsers such as:

- IGV (Integrative Genomics Viewer)

---

## Recommended Workflow

1. Process raw RNA-seq data using the **frtc pipeline**.
2. Generate 5â€², 3â€², and coverage `.bedgraph` files.
3. Run Break Points.
4. Visualize identified cleavage sites in IGV.
5. Perform downstream validation and biological interpretation.

---

## Citation

If you use Break Points in your research, please cite:

```
Facio Almeida, J.P. Break Points: Identification of endonuclease-dependent RNA cleavage sites from RNA-seq knockout data.
```

(Please update with DOI or publication details if available.)

---

## Contact

**JoÃ£o Paulo Facio Almeida**  
Email: jpfacio@usp.br  

For questions, bug reports, or collaboration inquiries, please open an issue in this repository or contact directly via email.
